<div id="<%= dom_id property %>" class="card shadow-sm">
  <div class="card-header d-flex justify-content-between align-items-center">
    <div class="fw-semibold">
      <i class="fas fa-building text-primary me-1"></i>
      <%= t("activerecord.models.property.one") %>
      #<%= property.id %>
    </div>
    <% if property.acquisition_date %>
      <span class="badge bg-secondary"><%= l(property.acquisition_date, format: :long) %></span>
    <% end %>
  </div>
  <div class="card-body">
    <h5 class="card-title mb-2"><%= property.address %></h5>
    <p class="text-muted mb-3"><%= property.description.presence || "—" %></p>
    <div class="row g-3">
      <div class="col-md-6">
        <div class="text-muted small"><%= t("activerecord.attributes.property.acquisition_date") %></div>
        <div class="fw-semibold"><%= l(property.acquisition_date, format: :medium) if property.acquisition_date %></div>
      </div>
      <div class="col-md-6">
        <div class="text-muted small"><%= t("activerecord.attributes.property.acquisition_price") %></div>
        <div class="fw-semibold"><%= number_to_currency(property.acquisition_price) if property.acquisition_price %></div>
      </div>
    </div>
    <span class="badge bg-info">
      <i class="fas fa-user text-white-50 me-1"></i>
      <%= pluralize(property.tenants.count, t("activerecord.models.tenant.one"), t("activerecord.models.tenant.other")) %>
    </span>
    <% range = defined?(@start_date) && defined?(@end_date) ? (@start_date..@end_date) : (..Date.today) %>
    <% scope = property.financial_operations.where(operation_date: range) %>
    <% income  = scope.where(category: "income").sum(:amount) %>
    <% expense = scope.where(category: "expense").sum(:amount) %>
    <% balance = income - expense %>
    <div>
      <span class="badge bg-success-subtle text-success">
        + <%= number_to_currency(income) %>
      </span>
      <span class="badge bg-danger-subtle text-danger">
        − <%= number_to_currency(expense) %>
      </span>
      <span class="badge <%= balance >= 0 ? 'bg-success text-white' : 'bg-danger text-white' %>">
        <%= number_to_currency(balance) %>
      </span>
    </div>
  </div>
  
  <div class="card-footer d-flex gap-2">
    <%= link_to t("helpers.show"), [property.company, property] %>
    <%= link_to t("helpers.edit"), edit_company_property_path(property.company, property) %>
    <%= link_to t("helpers.destroy"), [property.company, property], data: { turbo_method: :delete, turbo_confirm: t("helpers.are_you_sure") }, class: "text-danger" %>
  </div>
</div>